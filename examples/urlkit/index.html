<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>URLKit ("mod/urlkit")</title>
<link rel="stylesheet" href="../../stylesheets/styles.css">
<link rel="stylesheet" href="../../stylesheets/pygment_trac.css">
</head>
<body>

    <div class="wrapper">
      <header>
        <p class="logo">OzJS</p>
        <p class="header">OzJS is a microkernel for modular javascript, with bundles of powerful yet micro-framework friendly AMD</p>

        <ul class="buttons">
          <li><a class="buttons github" href="https://github.com/dexteryy/OzJS">View On GitHub</a></li>
          <li class="download"><a class="buttons" href="https://github.com/dexteryy/OzJS/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/dexteryy/OzJS/tarball/master">Download TAR</a></li>
        </ul>


      </header>

      <nav>
        <ul>
            <li><a href="/OzJS/#overview">Overview</a></li>
            <li>
                <a href="/OzJS/#toolchain">Toolchain</a>
                <ul>
                    <li><a href="http://dexteryy.github.com/OzJS/examples/buildtool/">OzmaJS</a></li>
                    <li><a href="https://github.com/dexteryy/grunt-ozjs">grunt-ozjs</a></li>
                    <li><a href="http://dexteryy.github.com/OzJS/examples/adapter/">adapter.js</a></li>
                </ul>
            </li>
            <li>
                <a href="/OzJS/#framework">Micro-framework</a>
                <ul>
                    <li><a href="http://dexteryy.github.com/OzJS/examples/event/">EventJS</a></li>
                    <li><a href="http://dexteryy.github.com/OzJS/examples/dollar/">DollarJS</a></li>
                    <li><a href="http://dexteryy.github.com/OzJS/examples/choreo/">ChoreoJS</a></li>
                    <li><a href="http://dexteryy.github.com/OzJS/examples/urlkit/">URLKit</a></li>
                    <li><a href="http://dexteryy.github.com/OzJS/examples/lang/">mod/lang</a></li>
                    <li><a href="/OzJS/#othermods">Other</a></li>
                </ul>
            </li>
            <li><a href="/OzJS/#start">Getting Started</a></li>
            <li><a href="/OzJS/#ref">References</a></li>
            <li><a href="/OzJS/#release">Release History</a></li>
        </ul>
      </nav>

      <section>


<h1>URLKit</h1>
<blockquote>
<ul>
<li>A lightweight implementation of routing and URL manager</li>
<li>Automatic switch between html5 History API and IE's hashbang</li>
</ul>
</blockquote>

<div class="article">

<h2>Get the code: </h2>
<p><a href="http://github.com/dexteryy/OzJS/blob/master/mod/urlkit.js">urlkit.js</a></p>

<h2>Source code for the demo:</h2>
<p><a href="https://github.com/dexteryy/OzJS/tree/master/examples/urlkit">View on Github</a></p>

<h2>Running result of the demo: </h2>
<ol>
<li>Open the developer console of the browser</li>
<li>Click the following links, then click the buttons below, and then try pressing browser's back/forward buttons.</li>
</ol>
<div>
    <ul class="url-list">
        <li><a href="house/0/room/1?page=1">[baseUrl]/house/0/room/1?page=1</a></li>
        <li><a href="house/0/room/1?page=2">[baseUrl]/house/0/room/1?page=2</a></li>
        <li><a href="house/1/room/2?page=1">[baseUrl]/house/1/room/2?page=1</a></li>
        <li><button class="btn1">url.nav({ '1': ++house_id, '2': false, 'page': ++page_id })</button></li>
        <li><button class="btn2">url.nav({ 'page': ++page_id }, { replace: true })</button></li>
    </ul>
</div>

<h2>API and usage:</h2>
<pre><code>var URLKit = require('mod/urlkit');</code></pre>
<ul>
<li><var>URLKit.parse(url)</var> -- </li>
<li><var>URLKit.param(urlObj, options)</var> -- </li>
<li><var>URLKit.SUPPORT_PUSHSTATE</var> -- </li>
</ul>
<pre><code>var url = URLKit({
    baseUrl: '', // optional, '/' for default
    win: window,  // optional
    autotidy: true // optional, true for default
});</code></pre>
<ul>
<li><var>url.listen()</var> -- </li>
<li><var>url.stop()</var> -- </li>
<li><var>url.route(rule, handler)</var> -- </li>
<li><var>url.nav(urlConfig, {
    /* replace: true,
    route: false */
})</var> -- </li>
<li><var>url.load(url, options)</var> -- </li>
<li><var>url.set(options)</var> -- </li>
<li><var>url.checkRules(url, rules)</var> -- </li>
<li><var>url.getBaseUrl()</var> -- </li>
</ul>
<p>Under construction...</p>


</div>

</section>

</div>

<script src="../../oz.js"></script>
<script>
require.config({
    baseUrl: '../../'
});

require([
    'lib/jquery',
    'mod/lang',
    'mod/urlkit'
], function($, _, URLKit){

    var url = URLKit({
        baseUrl: ''
    });

    url.route('default', function(){
        console.info('default: ', arguments);
    }).route('/house/:hid/room/:rid', function(params, hid, rid){
        console.info('route: ', hid, rid, params);
    });

    url.listen();

    $('.url-list a').click(function(){
        var href = this.href;
        if (URLKit.SUPPORT_PUSHSTATE) {
            href = href.replace(location.href
                .replace(/[^\/]*$/, ''), '');
        } else {
            href = href.replace(location.href
                .replace(/#.*/, '')
                .replace(/[^\/]*$/, ''), '#');
        }
        var parts = URLKit.parse(href);
        var params = parts.shift();
        _.mix(parts, params);
        url.nav(parts);
        return false;
    });

    $('.url-list button').click(function(){
        var code = this.innerHTML;
        var house_id = url.nav('1');
        var page_id = url.nav('page');
        console.info(house_id, typeof house_id)
        if (!house_id) {
            return alert('Click on any of the above links first!')
        }
        eval(code);
    });

});
</script>

</body>
</html>
